const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DMSar6kj.js","assets/index-DjiaUTh1.css"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-DMSar6kj.js";const w=(n,t=[])=>{if(!Array.isArray(n)||n.length===0)return"";const a=[{key:"name",label:"Project Name"},{key:"identifier",label:"Identifier"},{key:"description",label:"Description"},{key:"status",label:"Status"},{key:"region",label:"Region"},{key:"provider",label:"Provider"},{key:"type",label:"Type"},{key:"created_at",label:"Created At"}],e=t.length>0?t:a,o=e.map(l=>h(l.label)).join(","),d=n.map(l=>e.map(r=>{let s=l[r.key];return r.key.includes("_at")&&s&&(s=new Date(s).toLocaleString()),r.key.includes(".")&&(s=r.key.split(".").reduce((y,i)=>y==null?void 0:y[i],l)),s==null&&(s=""),h(String(s))}).join(","));return[o,...d].join(`
`)},h=n=>{if(n==null)return"";const t=String(n);return t.includes(",")||t.includes(`
`)||t.includes('"')?`"${t.replace(/"/g,'""')}"`:t},x=(n,t="projects.csv")=>{const a=new Blob([n],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a");if(e.download!==void 0){const o=URL.createObjectURL(a);e.setAttribute("href",o),e.setAttribute("download",t),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(o)}},g=async(n,t=[],a="projects.xlsx")=>{if(!Array.isArray(n)||n.length===0)throw new Error("No projects to export");try{const e=await b(()=>import("./index-DMSar6kj.js").then(i=>i.x),__vite__mapDeps([0,1])),o=[{key:"name",label:"Project Name"},{key:"identifier",label:"Identifier"},{key:"description",label:"Description"},{key:"status",label:"Status"},{key:"region",label:"Region"},{key:"provider",label:"Provider"},{key:"type",label:"Type"},{key:"created_at",label:"Created At"}],d=t.length>0?t:o,l=n.map(i=>{const p={};return d.forEach(c=>{let u=i[c.key];c.key.includes("_at")&&u&&(u=new Date(u).toLocaleString()),c.key.includes(".")&&(u=c.key.split(".").reduce((k,m)=>k==null?void 0:k[m],i)),p[c.label]=u??""}),p}),r=e.utils.json_to_sheet(l),s=e.utils.book_new();e.utils.book_append_sheet(s,r,"Projects");const f=50,y=d.map(i=>{const p=Math.max(i.label.length,...l.map(c=>String(c[i.label]||"").length));return{wch:Math.min(p+2,f)}});r["!cols"]=y,e.writeFile(s,a)}catch(e){throw console.error("Failed to export to Excel:",e),new Error("Excel export failed. Please try CSV export instead.")}},S=async(n,t,a="csv",e=[])=>{const o=n.filter(r=>t.includes(r.identifier));if(o.length===0)throw new Error("No projects selected for export");const l=`projects_${new Date().toISOString().split("T")[0]}`;if(a==="excel")await g(o,e,`${l}.xlsx`);else{const r=w(o,e);x(r,`${l}.csv`)}};export{x as downloadCSV,S as exportSelectedProjects,w as exportToCSV,g as exportToExcel};
//# sourceMappingURL=projectExport-DwGRCZWZ.js.map
