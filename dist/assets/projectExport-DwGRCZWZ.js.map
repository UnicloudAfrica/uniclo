{"version":3,"mappings":"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","names":["exportToCSV","projects","columns","defaultColumns","columnsToUse","header","col","escapeCSVValue","rows","project","value","obj","key","stringValue","downloadCSV","csvContent","filename","blob","link","url","exportToExcel","XLSX","n","data","row","worksheet","workbook","maxWidth","colWidths","maxLength","error","exportSelectedProjects","selectedIds","format","selectedProjects"],"ignoreList":[],"sources":["../../src/utils/projectExport.js"],"sourcesContent":["/**\n * Export projects to CSV format\n * @param {Array} projects - Array of projects to export\n * @param {Array} columns - Column configuration\n * @returns {string} CSV string\n */\nexport const exportToCSV = (projects, columns = []) => {\n  if (!Array.isArray(projects) || projects.length === 0) {\n    return \"\";\n  }\n\n  // Default columns if not provided\n  const defaultColumns = [\n    { key: \"name\", label: \"Project Name\" },\n    { key: \"identifier\", label: \"Identifier\" },\n    { key: \"description\", label: \"Description\" },\n    { key: \"status\", label: \"Status\" },\n    { key: \"region\", label: \"Region\" },\n    { key: \"provider\", label: \"Provider\" },\n    { key: \"type\", label: \"Type\" },\n    { key: \"created_at\", label: \"Created At\" },\n  ];\n\n  const columnsToUse = columns.length > 0 ? columns : defaultColumns;\n\n  // Create CSV header\n  const header = columnsToUse.map((col) => escapeCSVValue(col.label)).join(\",\");\n\n  // Create CSV rows\n  const rows = projects.map((project) => {\n    return columnsToUse\n      .map((col) => {\n        let value = project[col.key];\n\n        // Format dates\n        if (col.key.includes(\"_at\") && value) {\n          value = new Date(value).toLocaleString();\n        }\n\n        // Handle nested values\n        if (col.key.includes(\".\")) {\n          const keys = col.key.split(\".\");\n          value = keys.reduce((obj, key) => obj?.[key], project);\n        }\n\n        // Handle null/undefined\n        if (value == null) {\n          value = \"\";\n        }\n\n        return escapeCSVValue(String(value));\n      })\n      .join(\",\");\n  });\n\n  return [header, ...rows].join(\"\\n\");\n};\n\n/**\n * Escape CSV value\n * @param {string} value - Value to escape\n * @returns {string} Escaped value\n */\nconst escapeCSVValue = (value) => {\n  if (value == null) return \"\";\n\n  const stringValue = String(value);\n\n  // If value contains comma, newline, or quotes, wrap in quotes and escape quotes\n  if (stringValue.includes(\",\") || stringValue.includes(\"\\n\") || stringValue.includes('\"')) {\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n  }\n\n  return stringValue;\n};\n\n/**\n * Download CSV file\n * @param {string} csvContent - CSV content\n * @param {string} filename - Filename\n */\nexport const downloadCSV = (csvContent, filename = \"projects.csv\") => {\n  const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\n  const link = document.createElement(\"a\");\n\n  if (link.download !== undefined) {\n    const url = URL.createObjectURL(blob);\n    link.setAttribute(\"href\", url);\n    link.setAttribute(\"download\", filename);\n    link.style.visibility = \"hidden\";\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }\n};\n\n/**\n * Export projects to Excel format (requires xlsx library)\n * @param {Array} projects - Array of projects to export\n * @param {Array} columns - Column configuration\n * @param {string} filename - Filename\n */\nexport const exportToExcel = async (projects, columns = [], filename = \"projects.xlsx\") => {\n  if (!Array.isArray(projects) || projects.length === 0) {\n    throw new Error(\"No projects to export\");\n  }\n\n  try {\n    // Dynamically import xlsx to avoid bundling if not used\n    const XLSX = await import(\"xlsx\");\n\n    // Default columns if not provided\n    const defaultColumns = [\n      { key: \"name\", label: \"Project Name\" },\n      { key: \"identifier\", label: \"Identifier\" },\n      { key: \"description\", label: \"Description\" },\n      { key: \"status\", label: \"Status\" },\n      { key: \"region\", label: \"Region\" },\n      { key: \"provider\", label: \"Provider\" },\n      { key: \"type\", label: \"Type\" },\n      { key: \"created_at\", label: \"Created At\" },\n    ];\n\n    const columnsToUse = columns.length > 0 ? columns : defaultColumns;\n\n    // Transform data for Excel\n    const data = projects.map((project) => {\n      const row = {};\n      columnsToUse.forEach((col) => {\n        let value = project[col.key];\n\n        // Format dates\n        if (col.key.includes(\"_at\") && value) {\n          value = new Date(value).toLocaleString();\n        }\n\n        // Handle nested values\n        if (col.key.includes(\".\")) {\n          const keys = col.key.split(\".\");\n          value = keys.reduce((obj, key) => obj?.[key], project);\n        }\n\n        row[col.label] = value ?? \"\";\n      });\n      return row;\n    });\n\n    // Create workbook and worksheet\n    const worksheet = XLSX.utils.json_to_sheet(data);\n    const workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Projects\");\n\n    // Auto-size columns\n    const maxWidth = 50;\n    const colWidths = columnsToUse.map((col) => {\n      const maxLength = Math.max(\n        col.label.length,\n        ...data.map((row) => String(row[col.label] || \"\").length)\n      );\n      return { wch: Math.min(maxLength + 2, maxWidth) };\n    });\n    worksheet[\"!cols\"] = colWidths;\n\n    // Write file\n    XLSX.writeFile(workbook, filename);\n  } catch (error) {\n    console.error(\"Failed to export to Excel:\", error);\n    throw new Error(\"Excel export failed. Please try CSV export instead.\");\n  }\n};\n\n/**\n * Export selected projects\n * @param {Array} projects - All projects\n * @param {Array} selectedIds - Selected project identifiers\n * @param {string} format - Export format ('csv' or 'excel')\n * @param {Array} columns - Column configuration\n */\nexport const exportSelectedProjects = async (\n  projects,\n  selectedIds,\n  format = \"csv\",\n  columns = []\n) => {\n  const selectedProjects = projects.filter((project) => selectedIds.includes(project.identifier));\n\n  if (selectedProjects.length === 0) {\n    throw new Error(\"No projects selected for export\");\n  }\n\n  const timestamp = new Date().toISOString().split(\"T\")[0];\n  const filename = `projects_${timestamp}`;\n\n  if (format === \"excel\") {\n    await exportToExcel(selectedProjects, columns, `${filename}.xlsx`);\n  } else {\n    const csvContent = exportToCSV(selectedProjects, columns);\n    downloadCSV(csvContent, `${filename}.csv`);\n  }\n};\n\n/**\n * Get default export columns\n * @returns {Array} Default columns for export\n */\nexport const getDefaultExportColumns = () => [\n  { key: \"name\", label: \"Project Name\" },\n  { key: \"identifier\", label: \"Identifier\" },\n  { key: \"description\", label: \"Description\" },\n  { key: \"status\", label: \"Status\" },\n  { key: \"region\", label: \"Region\" },\n  { key: \"provider\", label: \"Provider\" },\n  { key: \"type\", label: \"Type\" },\n  { key: \"resources_count.instances\", label: \"Instances\" },\n  { key: \"resources_count.volumes\", label: \"Volumes\" },\n  { key: \"created_at\", label: \"Created At\" },\n  { key: \"updated_at\", label: \"Updated At\" },\n];\n\n/**\n * Prepare projects data for export with custom formatting\n * @param {Array} projects - Projects to prepare\n * @returns {Array} Formatted projects\n */\nexport const prepareProjectsForExport = (projects) => {\n  return projects.map((project) => ({\n    ...project,\n    status: (project.status || \"\").toUpperCase(),\n    region: (project.region || \"\").toUpperCase(),\n    provider: (project.provider || \"\").toUpperCase(),\n    created_at: project.created_at ? new Date(project.created_at).toLocaleString() : \"\",\n    updated_at: project.updated_at ? new Date(project.updated_at).toLocaleString() : \"\",\n    instances_count: project.resources_count?.instances || 0,\n    volumes_count: project.resources_count?.volumes || 0,\n  }));\n};\n"],"file":"assets/projectExport-DwGRCZWZ.js"}